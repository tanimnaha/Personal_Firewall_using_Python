# Web Application Vulnerability Scanner

A comprehensive web application vulnerability scanner built with Python and Flask that detects common security vulnerabilities including XSS, SQL Injection, CSRF, and missing security headers.

## Features

- **Cross-Site Scripting (XSS) Detection**: Identifies both reflected and stored XSS vulnerabilities
- **SQL Injection Testing**: Tests for SQL injection vulnerabilities using various payloads
- **CSRF Protection Check**: Verifies if forms have proper CSRF protection tokens
- **Security Headers Analysis**: Checks for missing important security headers
- **Web Crawling**: Automatically discovers forms and input fields on target websites
- **Modern Web Interface**: Clean, responsive Bootstrap-based UI for managing scans
- **Detailed Reports**: Comprehensive vulnerability reports with evidence and severity ratings
- **Scan History**: Save and manage multiple scan results
- **REST API**: JSON API endpoints for programmatic access

## Installation

1. **Clone or download the project**

   ```cmd
   cd d:\tonim2
   ```

2. **Install required packages**

   ```cmd
   pip install -r requirements.txt
   ```

3. **Run the application**

   ```cmd
   python app.py
   ```

4. **Access the web interface**
   Open your browser and go to: `http://localhost:5000`

## Usage

### Web Interface

1. **Start a New Scan**

   - Enter the target URL (e.g., `https://example.com`)
   - Select crawl depth (1-3 levels)
   - Click "Start Vulnerability Scan"

2. **View Results**

   - Scan results are automatically saved and categorized by severity
   - Critical, High, Medium, and Low severity vulnerabilities are color-coded
   - Each vulnerability includes detailed evidence and payload information

3. **Manage Scans**
   - View all scan history from the "Scan Results" page
   - Delete old scan results as needed
   - Track statistics across all scans

### API Endpoints

- **POST /api/scan**: Start a new scan

  ```json
  {
    "url": "https://example.com",
    "max_depth": 2
  }
  ```

- **GET /api/results**: Get all scan results

## Vulnerability Types Detected

### 1. Cross-Site Scripting (XSS)

- Tests multiple XSS payloads in form fields
- Detects reflected XSS vulnerabilities
- Severity: **High**

### 2. SQL Injection

- Tests various SQL injection payloads
- Detects database error messages
- Covers MySQL, PostgreSQL, SQL Server, Oracle, and Access
- Severity: **Critical**

### 3. Cross-Site Request Forgery (CSRF)

- Checks for missing CSRF tokens in POST forms
- Identifies forms vulnerable to CSRF attacks
- Severity: **Medium**

### 4. Security Headers

- X-Frame-Options (Clickjacking protection)
- X-XSS-Protection
- X-Content-Type-Options
- Strict-Transport-Security (HSTS)
- Content-Security-Policy (CSP)
- Severity: **Low**

## Security Considerations

⚠️ **Important**: This tool is for educational and authorized testing purposes only.

- Only scan websites you own or have explicit permission to test
- Be aware of rate limiting and don't overwhelm target servers
- Some payloads may trigger security systems or WAFs
- Always follow responsible disclosure practices

## Project Structure

```
d:\tonim2\
├── app.py                 # Flask web application
├── scanner.py             # Core vulnerability scanning logic
├── requirements.txt       # Python dependencies
├── README.md             # This file
├── templates/            # HTML templates
│   ├── base.html         # Base template with navigation
│   ├── index.html        # Home page with scan form
│   ├── results.html      # Individual scan results
│   └── results_list.html # Scan history
└── data/                 # Scan results storage (created automatically)
```

## Technical Details

### Scanner Components

1. **Web Crawler**: Uses requests and BeautifulSoup to discover forms and input fields
2. **Payload Testing**: Systematic testing of vulnerability payloads
3. **Response Analysis**: Pattern matching and error detection
4. **Report Generation**: Structured vulnerability reporting with evidence

### Technologies Used

- **Backend**: Python 3.7+, Flask
- **Web Scraping**: requests, BeautifulSoup4
- **Frontend**: Bootstrap 5, Font Awesome
- **Data Storage**: JSON files (easily extendable to databases)

## Configuration

### Environment Variables

You can set these in a `.env` file:

```
FLASK_DEBUG=True
SECRET_KEY=your-secret-key-here
MAX_SCAN_DEPTH=3
SCAN_TIMEOUT=30
```

### Customization

1. **Add New Payloads**: Edit the payload lists in `scanner.py`
2. **Modify UI**: Update templates in the `templates/` directory
3. **Add Vulnerability Types**: Extend the `VulnerabilityScanner` class
4. **Change Storage**: Modify the save/load functions in `app.py`

## Troubleshooting

### Common Issues

1. **Import Errors**: Make sure all requirements are installed

   ```cmd
   pip install -r requirements.txt
   ```

2. **Permission Denied**: Ensure the application has write permissions for the `data/` directory

3. **Connection Timeouts**: Some websites may block automated requests. Consider:

   - Reducing scan depth
   - Adding delays between requests
   - Using different User-Agent strings

4. **False Positives**: The scanner may report false positives. Always manually verify findings.

## Contributing

Feel free to contribute by:

- Adding new vulnerability detection methods
- Improving the web interface
- Adding export functionality (PDF, CSV)
- Implementing database storage
- Adding authentication and multi-user support

## License

This project is for educational purposes. Use responsibly and only on systems you own or have permission to test.

## Disclaimer

This tool is provided "as is" without any warranties. The authors are not responsible for any misuse or damage caused by this tool. Always obtain proper authorization before testing any systems.
