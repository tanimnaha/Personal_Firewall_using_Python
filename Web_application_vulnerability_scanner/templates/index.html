{% extends "base.html" %} {% block content %}
<div class="scanner-header">
  <div class="container text-center">
    <h1 class="display-4 mb-3">
      <i class="fas fa-search me-3"></i>
      Web Application Vulnerability Scanner
    </h1>
    <p class="lead">
      Detect common web vulnerabilities including XSS, SQL Injection, CSRF, and
      security header issues
    </p>
  </div>
</div>

<div class="container my-5">
  <div class="row justify-content-center">
    <div class="col-lg-8">
      <div class="scan-form">
        <h3 class="mb-4 text-center">
          <i class="fas fa-globe text-primary me-2"></i>
          Start New Scan
        </h3>

        <form method="POST" action="{{ url_for('scan') }}" id="scanForm">
          <div class="mb-4">
            <label for="url" class="form-label fw-bold">Target URL</label>
            <div class="input-group">
              <span class="input-group-text">
                <i class="fas fa-link"></i>
              </span>
              <input
                type="url"
                class="form-control form-control-lg"
                id="url"
                name="url"
                placeholder="https://example.com"
                required
              />
            </div>
            <div class="form-text">
              Enter the URL of the website you want to scan for vulnerabilities.
            </div>
          </div>

          <div class="mb-4">
            <label for="max_depth" class="form-label fw-bold"
              >Crawl Depth</label
            >
            <select class="form-select" id="max_depth" name="max_depth">
              <option value="1">Shallow (1 level)</option>
              <option value="2" selected>Medium (2 levels)</option>
              <option value="3">Deep (3 levels)</option>
            </select>
            <div class="form-text">
              How deep should the scanner crawl through the website's links.
            </div>
          </div>

          <div class="d-grid">
            <button type="submit" class="btn btn-primary btn-lg" id="scanBtn">
              <i class="fas fa-play me-2"></i>
              Start Vulnerability Scan
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Feature Overview -->
  <div class="row mt-5">
    <div class="col-12">
      <h3 class="text-center mb-4">What We Scan For</h3>
    </div>
    <div class="col-md-3 mb-3">
      <div class="card h-100 card-hover">
        <div class="card-body text-center">
          <i class="fas fa-code text-danger fa-3x mb-3"></i>
          <h5 class="card-title">Cross-Site Scripting (XSS)</h5>
          <p class="card-text">
            Detects reflected and stored XSS vulnerabilities in forms and
            parameters.
          </p>
        </div>
      </div>
    </div>
    <div class="col-md-3 mb-3">
      <div class="card h-100 card-hover">
        <div class="card-body text-center">
          <i class="fas fa-database text-warning fa-3x mb-3"></i>
          <h5 class="card-title">SQL Injection</h5>
          <p class="card-text">
            Identifies SQL injection vulnerabilities by testing common payloads.
          </p>
        </div>
      </div>
    </div>
    <div class="col-md-3 mb-3">
      <div class="card h-100 card-hover">
        <div class="card-body text-center">
          <i class="fas fa-shield-alt text-info fa-3x mb-3"></i>
          <h5 class="card-title">CSRF Protection</h5>
          <p class="card-text">
            Checks for missing CSRF tokens in forms that modify data.
          </p>
        </div>
      </div>
    </div>
    <div class="col-md-3 mb-3">
      <div class="card h-100 card-hover">
        <div class="card-body text-center">
          <i class="fas fa-lock text-success fa-3x mb-3"></i>
          <h5 class="card-title">Security Headers</h5>
          <p class="card-text">
            Verifies presence of important security headers like CSP, HSTS, etc.
          </p>
        </div>
      </div>
    </div>
  </div>

  {% if recent_scans %}
  <div class="row mt-5">
    <div class="col-12">
      <h3 class="mb-4">Recent Scans</h3>
      <div class="table-responsive">
        <table class="table table-hover">
          <thead class="table-dark">
            <tr>
              <th>URL</th>
              <th>Scan Time</th>
              <th>Vulnerabilities Found</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            {% for scan in recent_scans[:5] %}
            <tr>
              <td>{{ scan.url }}</td>
              <td>{{ scan.scan_time.split('T')[0] }}</td>
              <td>
                <span class="badge bg-danger me-1"
                  >{{ scan.summary.critical }} Critical</span
                >
                <span class="badge bg-warning me-1"
                  >{{ scan.summary.high }} High</span
                >
                <span class="badge bg-info me-1"
                  >{{ scan.summary.medium }} Medium</span
                >
                <span class="badge bg-success">{{ scan.summary.low }} Low</span>
              </td>
              <td>
                <a
                  href="{{ url_for('results', filename=scan.filename) }}"
                  class="btn btn-sm btn-outline-primary"
                >
                  <i class="fas fa-eye me-1"></i>View
                </a>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
  {% endif %}
</div>
{% endblock %} {% block scripts %}
<script>
  document.getElementById("scanForm").addEventListener("submit", function (e) {
    const scanBtn = document.getElementById("scanBtn");
    scanBtn.innerHTML =
      '<i class="fas fa-spinner fa-spin me-2"></i>Scanning...';
    scanBtn.disabled = true;
  });
</script>
{% endblock %}
