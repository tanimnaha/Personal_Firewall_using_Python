"""
Demo script to test the vulnerability scanner on common vulnerable targets
"""
import sys
import time
from scanner import VulnerabilityScanner

def demo_scan():
    """Demonstrate scanner capabilities"""
    print("=" * 60)
    print("Web Application Vulnerability Scanner - Demo")
    print("=" * 60)
    
    scanner = VulnerabilityScanner()
    
    # Demo URLs (these are intentionally vulnerable test sites)
    test_urls = [
        "http://testphp.vulnweb.com/",  # Vulnerable PHP test site
        "https://httpbin.org/forms/post",  # Simple form for testing
    ]
    
    print("\nNote: This demo uses publicly available test sites.")
    print("Only scan websites you own or have permission to test.\n")
    
    for i, url in enumerate(test_urls, 1):
        print(f"\n{i}. Testing: {url}")
        print("-" * 50)
        
        try:
            # Perform scan with limited depth for demo
            scan_result = scanner.scan_website(url, max_depth=1)
            
            # Display results
            print(f"Scan completed for: {scan_result['url']}")
            print(f"Total vulnerabilities found: {scan_result['summary']['total_vulnerabilities']}")
            
            if scan_result['vulnerabilities']:
                print("\nVulnerabilities found:")
                for vuln in scan_result['vulnerabilities']:
                    print(f"  - {vuln['type']} ({vuln['severity']}) in {vuln['parameter']}")
                    print(f"    Evidence: {vuln['evidence']}")
            else:
                print("No vulnerabilities detected.")
                
        except Exception as e:
            print(f"Error scanning {url}: {str(e)}")
        
        # Add delay between scans
        if i < len(test_urls):
            print("\nWaiting before next scan...")
            time.sleep(2)
    
    print("\n" + "=" * 60)
    print("Demo completed!")
    print("Start the web interface with: python app.py")
    print("=" * 60)

if __name__ == "__main__":
    demo_scan()
